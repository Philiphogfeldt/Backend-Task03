@page
@model Backend_Task03.Pages.Beers.IndexModel
@inject Backend_Task03.Data.AccessControl AccessControl

@{
	ViewData["Title"] = "Index";
}


<div id="beerIndex">
	<h1 id="beerHead">Beer</h1>

	@*<p>*@
	<form asp-page="Create" method="get" id="beerCreate">
		@if (AccessControl.LoggedInAccountRole == "Admin")
		{
			<button type="submit" class="btn btn-primary">Create New</button>
		}
	</form>
	@*</p>*@

	@foreach (var item in Model.Beer)
	{
		<div class="beerIndexCell">
			<h3 id="beerName">@Html.DisplayFor(modelItem => item.Name)</h3>
			<p id="beerCountry">(@Html.DisplayFor(modelItem => item.Country))</p>

			<p id="beerBrewery">@Html.DisplayFor(modelItem => item.Brewery)</p>

			<p id="beerPercentage">@Html.DisplayFor(modelItem => item.Percentage)%</p>

			<div id="beerImage">
				<img id="smBeerImage" src="~/imagesBeerly/@(item.Name).png" width="100px" />
			</div>

			<p id="beerType">@Html.DisplayFor(modelItem => item.Type)</p>

			<div id="beerGoesWellWith">
				@*@Html.DisplayFor(modelItem => item.GoesWellWith)*@
				@if (item.GoesWellWith.Contains("Chicken"))
				{
					<img asp-append-version="true" name="Goesw" value="Chicken" src="images/chicken.svg" style="width: 25px" />
				}

				@if (item.GoesWellWith.Contains("Meat"))
				{
					<img asp-append-version="true" name="Goesw" value="Meat" src="images/meat.svg" style="width: 25px" />
				}

				@if (item.GoesWellWith.Contains("Fish"))
				{
					<img asp-append-version="true" name="Goesw" value="Fish" src="images/fish.svg" style="width: 25px" />
				}

				@if (item.GoesWellWith.Contains("Vegetarian"))
				{
					<img asp-append-version="true" name="Goesw" value="Vegetarian" src="images/veg.svg" style="width: 25px" />
				}

				@if (item.GoesWellWith.Contains("Dessert"))
				{
					<img asp-append-version="true" name="Goesw" value="Dessert" src="images/dessert.svg" style="width: 25px" />
				}
			</div>

			<p id="beerRating">Our users give this beer an average @Html.DisplayFor(modelItem => item.Rating) of 5.</p>

			<button type="button" id="beerDetailsButton" onclick="location.href='@Url.Page("./Details", new { id = item.ID, name = item.Name })'">Details</button>
			<div id="beerFavoriteCell">

				<div id="beerFavoriteCell">
					<form asp-page-handler="ToggleFavorite" method="post">
						<input type="hidden" name="beerId" value="@(item.ID)" />
						<input type="checkbox" id="@(item.ID)Checkbox" class="beerFavoriteCheckbox visually-hidden" onchange="this.form.submit()" @(Model.IsFavorite(item.ID) ? "checked" : "") />
						<label for="@(item.ID)Checkbox" class="beerFavoriteLabel">
							<span class="unfilledStar">
								<img class="beerlyStar" src="~/imagesBeerly/beerlyStarLH.png" alt="Not Filled Star">
							</span>
							<span class="filledStar">
								<img class="beerlyStar checked" src="~/imagesBeerly/beerlyStarFav.png" alt="Filled Star">
							</span>
						</label>
					</form>

					@* Funkar 
					@*<form asp-page-handler="ToggleFavorite" method="post">
						<input type="hidden" name="beerId" value="@(item.ID)" />
						<input type="checkbox" onchange="this.form.submit()" class="beerFavoriteCheckbox" @(Model.IsFavorite(item.ID) ? "checked" : "") />
					</form>*@


					@*<input type="checkbox" id="@(item.Name)Checkbox" class="beerFavoriteCheckbox visually-hidden">
					<label for="@(item.Name)Checkbox" class="beerFavoriteLabel">
						<img class="beerlyStar" src="~/imagesBeerly/beerlyStarLH.png" alt="Not Filled Star">
						<img class="beerlyStar checked" src="~/imagesBeerly/beerlyStarFav.png" alt="Filled Star">
					</label>*@
				</div>





@*				<script>
					const checkbox = document.getElementById('@(item.Name)Checkbox');
					const starUnselected = checkbox.previousElementSibling;
					const starSelected = checkbox.nextElementSibling.querySelector('.checked');

					checkbox.addEventListener('change', function () {
						if (checkbox.checked) {
							starUnselected.style.display = 'none';
							starSelected.style.display = 'grid';
						} else {
							starUnselected.style.display = 'grid';
							starSelected.style.display = 'none';
						}
					});
				</script>*@

@*				<input type="checkbox" id="beerFavoriteCheckbox_@(item.Name)" class="beerFavoriteCheckbox visually-hidden">
				<label for="beerFavoriteCheckbox_@(item.Name)" class="beerFavoriteLabel">
					<img class="beerlyStar not-filled" src="~/imagesBeerly/beerlyStarLH.png" alt="Not Filled Star">
					<img class="beerlyStar filled" src="~/imagesBeerly/beerlyStarFav.png" alt="Filled Star">
				</label>*@

@*				<input type="checkbox" id="@(item.Name)Checkbox" class="@(item.Name)Checkbox visually-hidden">
				<label for="@(item.Name)Checkbox" class="@(item.Name)CheckboxLabel"></label>*@


@*				<input type="checkbox" id="beerFavoriteCheckbox" class="beerFavoriteCheckbox visually-hidden">
				<label for="beerFavoriteCheckbox" class="beerFavoriteLabel">
					<img class="beerlyStar" src="~/imagesBeerly/beerlyStarLH.png" alt="Not Filled Star">
					<img class="beerlyStar checked" src="~/imagesBeerly/beerlyStarFav.png" alt="Filled Star">
				</label>

				<img src="~/imagesBeerly/beerlyStarLH.png" />*@
			</div>
		</div>

		<script>
			document.addEventListener('DOMContentLoaded', function () {
				const checkboxes = document.querySelectorAll('.beerFavoriteCheckbox');

				checkboxes.forEach(function (checkbox) {
					const label = checkbox.nextElementSibling;

					checkbox.addEventListener('change', function () {
						const starUnselected = label.querySelector('.beerlyStar');
						const starSelected = label.querySelector('.beerlyStar.checked');

						if (checkbox.checked) {
							starUnselected.style.display = 'none';
							starSelected.style.display = 'grid';
						} else {
							starUnselected.style.display = 'grid';
							starSelected.style.display = 'none';
						}
					});
				});
			});
		</script>



		@*<script>
			(function () {
				const checkboxes = document.querySelectorAll('.beerFavoriteCheckbox');
				checkboxes.forEach(function (checkbox) {
					const starUnselected = checkbox.previousElementSibling.querySelector('.beerlyStar');
					const starSelected = checkbox.nextElementSibling.querySelector('.beerlyStar.checked');

					checkbox.addEventListener('change', function () {
						if (checkbox.checked) {
							starUnselected.style.display = 'none';
							starSelected.style.display = 'grid';
						} else {
							starUnselected.style.display = 'grid';
							starSelected.style.display = 'none';
						}
					});
				});
			})();
		</script>*@

@*		<script>
			const checkboxes = document.querySelectorAll('.beerFavoriteCheckbox');
			checkboxes.forEach(function (checkbox) {
				const starUnselected = checkbox.previousElementSibling.querySelector('.beerlyStar');
				const starSelected = checkbox.nextElementSibling.querySelector('.beerlyStar.checked');

				checkbox.addEventListener('change', function () {
					if (checkbox.checked) {
						starUnselected.style.display = 'none';
						starSelected.style.display = 'grid';
					} else {
						starUnselected.style.display = 'grid';
						starSelected.style.display = 'none';
					}
				});
			});
		</script>*@
	}

	@*
	<table class="table">
	<thead>
	<tr>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Name)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Type)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Percentage)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Brewery)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Country)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].GoesWellWith)
	</th>
	<th>
	@Html.DisplayNameFor(model => model.Beer[0].Rating)
	</th>
	</tr>
	</thead>
	<tbody>
		@foreach (var item in Model.Beer)
		{
			<tr>
				<td>
					@Html.DisplayFor(modelItem => item.Name)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Type)
				</td>
				<td>
						@Html.DisplayFor(modelItem => item.Percentage)%
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Brewery)
				</td>
				<td>
					@Html.DisplayFor(modelItem => item.Country)
				</td>
				<td>

	@if (item.GoesWellWith.Contains("Chicken"))
	{
	<img asp-append-version="true" name="Goesw" value="Chicken" src="images/chicken.svg" style="width: 25px" />
	}

	@if (item.GoesWellWith.Contains("Meat"))
	{
	<img asp-append-version="true" name="Goesw" value="Meat" src="images/meat.svg" style="width: 25px" />
	}

	@if (item.GoesWellWith.Contains("Fish"))
	{
	<img asp-append-version="true" name="Goesw" value="Fish" src="images/fish.svg" style="width: 25px" />
	}

	@if (item.GoesWellWith.Contains("Vegetarian"))
	{
	<img asp-append-version="true" name="Goesw" value="Vegetarian" src="images/veg.svg" style="width: 25px" />
	}

	@if (item.GoesWellWith.Contains("Dessert"))
	{
	<img asp-append-version="true" name="Goesw" value="Dessert" src="images/dessert.svg" style="width: 25px" />
	}

	</td>
	<td>
	@Html.DisplayFor(modelItem => item.Rating)
	</td>

					<td>
						@if (AccessControl.LoggedInAccountRole == "Admin")
						{
							<button type="button" onclick="location.href='@Url.Page("./Edit2", new { id = item.ID,  name = item.Name })'">Edit</button>
							<button type="button" onclick="location.href='@Url.Page("./Delete", new { id = item.ID, name = item.Name })'">Delete</button>
						}
						<form method="post" asp-page-handler="AddToFavorites" asp-route-beerId="@item.ID">
							<button type="submit">Add to favorites</button>
						</form>
						<button type="button" onclick="location.href='@Url.Page("./Details", new { id = item.ID, name = item.Name })'">Details</button>

	</td>
	</tr>
	}
	</tbody>
	</table>
	*@
</div>

